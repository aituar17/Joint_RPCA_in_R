---
title: "IBDMDB â€” 3-Omic Joint-RPCA (MGX + MTX + 16S)"
format: html
editor: visual
---

```{r setup, message = FALSE, warning = FALSE}
options(warn = -1)

#dependencies & user functions
source("../R/dependencies.R")
source("../R/jointRPCA.R")
source("../R/jointRPCAuniversal.R")
source("../R/jointOptspaceHelper.R")
source("../R/jointOptspaceSolve.R")
source("../R/optspaceHelper.R")
source("../R/transformHelper.R")
source("../R/transform.R")
source("../R/maskValueOnly.R")
source("../R/rpcaTableProcessing.R")
source("../R/jointRPCAutils.R")

left_join  <- dplyr::left_join
inner_join <- dplyr::inner_join
`%||%` <- function(a,b) if (is.null(a)) b else a

#paths 
f_mgx_al <- "data_ibdmdb_raw/aligned_MGX.tsv"
f_mtx_al <- "data_ibdmdb_raw/aligned_MTX.tsv"
f_16s_al <- "data_ibdmdb_raw/aligned_16S.tsv"
f_meta   <- "data_ibdmdb_raw/hmp2_metadata_2018-08-20.csv"

stopifnot(file.exists(f_mgx_al), file.exists(f_mtx_al), file.exists(f_16s_al))

for (f in c(f_mgx_al, f_mtx_al, f_16s_al)) {
  cat("\n==== Checking", f, "====\n")
  dt <- data.table::fread(f, sep = "\t", nrows = 5)
  print(dim(dt))
  print(head(dt[,1:3]))
}

dt_mtx <- data.table::fread(f_mtx_al, sep = "\t")
nrow(dt_mtx)
length(unique(dt_mtx[[1]]))

```
